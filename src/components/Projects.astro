---
import CardProject from "./CardProject.astro";
import {
  featuredProjects,
  learningProjects,
  tabButtons,
} from "../data/projects";
---

<section
  id="projects"
  class="relative flex min-h-screen w-full items-start py-20 m-auto scroll-smooth mb-[-100px] md:mb-[-350px]"
>
  <div
    class="absolute -z-20 inset-0 bg-[linear-gradient(rgba(255,255,255,.05)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,.05)_1px,transparent_1px)] bg-[size:4rem_4rem] [mask-image:radial-gradient(ellipse_80%_80%_at_50%_50%,black,transparent)]"
  >
  </div>
  <div class="container mx-auto md:px-4">
    <div class="w-full md:max-w-6xl m-auto">
      <h2
        class="text-3xl font-medium tracking-tight sm:text-4xl mb-1 text-center"
      >
        Proyectos
      </h2>
      <p class="text-base text-muted-foreground text-center mb-8 text-pretty">
        Una muestra de mi progreso y aprendizaje en el desarrollo web.
      </p>

      <!-- Botones de navegación -->
      <div class="flex justify-center gap-4 mb-8 flex-wrap">
        <div class="w-full">
          <div class="flex justify-center md:p-6">
            {
              tabButtons.map((tab) => (
                <button
                  class={`tab-button-project ${tab === "proyectos destacados" ? "active" : ""} flex items-center justify-center whitespace-nowrap text-muted-foreground text-base font-medium transition-all border border-muted bg-background hover:bg-accent hover:text-accent-foreground w-full md:w-auto h-10 md:px-10 py-6 capitalize cursor-pointer relative`}
                  data-tab={tab.replace(/\s+/g, "-")}
                >
                  {tab}
                </button>
              ))
            }
          </div>

          <!-- Contenido de las tabs -->
          <div class="tab-content-project">
            <!-- Proyectos Destacados Panel -->
            <div class="tab-panel-project active" id="proyectos-destacados">
              <div class="flex flex-col gap-6">
                {
                  featuredProjects.map((project, index) => (
                    <CardProject
                      name={project.name}
                      description={project.description}
                      tags={project.tags}
                      imagen={project.imagen}
                      github={project.github}
                      demo={project.demo}
                      left={index % 2 === 0}
                    />
                  ))
                }
              </div>
            </div>

            <!-- Proyectos de Aprendizaje Panel -->
            <div class="tab-panel-project" id="proyectos-de-aprendizaje">
              <div class="flex flex-col gap-6">
                {
                  learningProjects.length > 0 ? (
                    learningProjects.map((project, index) => (
                      <CardProject
                        name={project.name}
                        description={project.description}
                        tags={project.tags}
                        imagen={project.imagen}
                        github={project.github}
                        demo={project.demo}
                        left={index % 2 === 0}
                      />
                    ))
                  ) : (
                    <div class="text-center py-12 text-muted-foreground">
                      <p class="text-lg">
                        Pronto agregaré más proyectos de aprendizaje aquí.
                      </p>
                    </div>
                  )
                }
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const buttons = document.querySelectorAll(".tab-button-project");
      const panels = document.querySelectorAll(".tab-panel-project");

      buttons.forEach((button) => {
        button.addEventListener("click", () => {
          const targetTab = button.getAttribute("data-tab");
          if (!targetTab) return;

          // Remover clase active de todos los botones y paneles
          buttons.forEach((btn) => btn.classList.remove("active"));
          panels.forEach((panel) => panel.classList.remove("active"));

          // Agregar clase active al botón clickeado y su panel
          button.classList.add("active");
          const targetPanel = document.getElementById(targetTab);
          if (targetPanel) {
            targetPanel.classList.add("active");
          }
        });
      });
    });
  </script>

  <style>
    .tab-button-project {
      overflow: visible;
    }

    .tab-button-project::after {
      content: "";
      position: absolute;
      bottom: 0px;
      left: 0;
      width: 100%;
      height: 2px;
      background-color: var(--color-ring);
      z-index: 10;
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.2s ease-out;
    }

    .tab-button-project.active {
      color: hsl(var(--primary));
    }

    .tab-button-project.active::after {
      transform: scaleX(1);
    }

    .tab-panel-project {
      display: none;
      animation: fadeIn 0.3s ease-in-out;
    }

    .tab-panel-project.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</section>
